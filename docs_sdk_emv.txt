Table of Contents
[cite_start]Introduction [cite: 1]
1. [cite_start]Premise [cite: 1]
2. [cite_start]Run Arke VAS Demo to invoke Argo Demo [cite: 1]
3. [cite_start]Architecture [cite: 1]
4. [cite_start]Arke VAS Application Invoke Argo Interface Standard [cite: 1]
5. [cite_start]How to develop [cite: 1]

Introduction
[cite_start]This document is in order to help you to learn the arke vas demo how to invoke the arke application and complete a series of transactions. [cite: 1]

Structure
[cite_start]The folder's structure as below: [cite: 2]
[cite_start]SDK [cite: 2]
| [cite_start]+---README.pdf // Tutorial [cite: 2]
| [cite_start]+---CHANGELOG [cite: 2]
| [cite_start]+---assets [cite: 2]
| [cite_start]+---dist // Installation package by APKs into uns format [cite: 3]
| | | [cite_start]---install.uns [cite: 3]
| [cite_start]+---doc // The documentation of telling you how to call the arke applic ation [cite: 4]
| [cite_start]+---en [cite: 4]
| | | [cite_start]---zh-CN [cite: 4]
| +---src // Arke VAS Demo. [cite_start]This is a demo to invoke arke application to do sale or sale void transaction [cite: 5]

2. Premise
[cite_start]IDE [cite: 6]
[cite_start]Install the latest version of Android Studio, Click me to download. [cite: 6] [cite_start]Android SDK API Level: 24. [cite: 6]

[cite_start]Application product [cite: 6]
[cite_start]A8 [cite: 6]
[cite_start]Android version: 5.1.1 Boot version: 1.1.2 OS version: 1.1.0 [cite: 6]

[cite_start]Dependent [cite: 6]
[cite_start]Install arke application [cite: 6]

[cite_start]Documentation [cite: 6]
[cite_start]The apk installation package install.uns , path: arke-vas-demo\dist\install.uns [cite: 6]
[cite_start]The source code of arke-vas-demo , path: arke-vas-demo\src [cite: 6]
[cite_start]The interface documentation of arke-vas-demo , path: arke-vas-demo\doc [cite: 6]

[cite_start]Operation for First run [cite: 6]
1. [cite_start]Use Download_Tool to install install.uns , path: arke-vas-demo\dist\install.uns [cite: 6]
2. [cite_start]After the installation is successful, open the Arke Pay , Swipe left and click TRY IT NOW to enter the login page [cite: 6]
3. [cite_start]Input the account 01 , password 0000 . [cite: 9]
4. [cite_start]Login to Arke Pay , whether to enter the main interface [cite: 10]
5. [cite_start]If the Load pin key error error occurs, manually downloads the master key [cite: 11]
6. [cite_start]Manually downloads the master key In the login interface, enter the account 99 , password 12345678 [cite: 12]
[cite_start]Select Terminal Key Management [cite: 13]
[cite_start]Select Input Master Key Manually [cite: 14]
[cite_start]Enter the master key 31313131313131313131313131313131 [cite: 15]
[cite_start]Set up successfully [cite: 16]
[cite_start]Return to the login interface, enter the account 01 , password 0000 , whether the login is successful, as shown below [cite: 17]

[cite_start]How to Run arke-vas-demo [cite: 20]
1. [cite_start]Make sure that the Arke application is installed and that the Arke application is working properly. [cite: 20]
2. [cite_start]Run Android Studio and import arke-vas-demo Project. [cite: 21] [cite_start]The path is: /src , follow these steps: [cite: 21]
3. [cite_start]Computer and APOS connection, run arke-vas-demo project [cite: 22]
4. [cite_start]After you run as the projects. [cite: 23] [cite_start]You will see two apps in the device desktop [cite: 23]

[cite_start]How to Use arke vas demo [cite: 24]
1. [cite_start]Open arke-vas-demo.apk [cite: 24]
2. [cite_start]Choose the amount and input the value of 100.00. [cite: 25]
3. [cite_start]Click "Consume" transaction [cite: 26]
4. [cite_start]Tap card/Insert card/swipe card to get the card number [cite: 28]
5. [cite_start]Input the password [cite: 29]
6. [cite_start]Transaction process [cite: 30]
7. [cite_start]Print receipt [cite: 31]
8. [cite_start]Click ENTE , then return to arke-vas-demo [cite: 32]

[cite_start]Architecture [cite: 34]
[cite_start]Flow diagram [cite: 34]
[cite_start]Sequence diagram [cite: 34]
[cite_start]State diagram [cite: 35]

[cite_start]Arke VAS Application Invoke Arke Interface Standard [cite: 36]
1. [cite_start]Invoke Method [cite: 36]
[cite_start]Arke application package name: com.arke [cite: 36]
[cite_start]Arke Project Processing Activity: com.arke.thirdcalling.ThirdPartyCallingActivity ; [cite: 36]
[cite_start]The arke vas application build parameters(refer to 2.1), then use startActivityForResult to invoke Argo [cite: 37]
[cite_start]The arke vas application will received the result(refer to 2.2) after transaction finished. [cite: 37]

2. [cite_start]Parameter Description [cite: 38]
[cite_start]2.1 Request Data Description [cite: 38]
Index | Field Name | Data Type | Size | Needed | [cite_start]Description [cite: 38]
1 | applicationName | String | | Y | [cite_start]Application name, currently fixed for ArkeAcquiringProject [cite: 38]
2 | transactionName | String | | Y | [cite_start]Transaction name [cite: 38]
3 | transactionData | String | | N | [cite_start]Transaction data, JSON format string data. [cite: 38] (See specific transaction data 3) [cite_start][cite: 39]

[cite_start]Description [cite: 39]
[cite_start]In the case of whether it is necessary of the request parameter is "Y", the Arke VAS application must pass in this parameter, otherwise the Arke application considers the call to be invalid. [cite: 39]
[cite_start]In the case of whether it is necessary of the request parameter is "N". [cite: 40] [cite_start]If the Arke VAS application delivered this parameter, arke application processing it. [cite: 41] [cite_start]If no,getting data by the Arke application of self-collection. [cite: 41]

[cite_start]Example (eg : Sale) [cite: 42]
[cite_start]The Arke VAS application invoke Arke [cite: 42]
[cite_start]Intent intent = new Intent(); [cite: 42]
[cite_start]ComponentName compName = new ComponentName("com.arke", "com.arke.thirdcalling.ThirdPartyCallingActivity"); [cite: 42]
[cite_start]intent.setComponent(compName); [cite: 42]
[cite_start]intent.putExtra("applicationName", "ArkeAcquiringProject"); [cite: 43]
[cite_start]intent.putExtra("transactionName", "Consume"); [cite: 43]
intent.putExtra("transactionData", transactionData); [cite_start]// transactionData : {"amount":15.55} [cite: 43]
[cite_start]startActivityForResult(intent, requestCode); [cite: 43]

[cite_start]2.2 Response Data Description [cite: 43]
Index | Field Name | Data Type | Size | Needed | [cite_start]Description [cite: 44]
1 | applicationName | String | | Y | [cite_start]Application name, currently fixed for ArkeAcquiringProject [cite: 44]
2 | transactionName | String | | Y | [cite_start]Transaction name [cite: 44]
3 | responseCode | String | | Y | [cite_start]Invoke interface result code, return transactionData when 00 or 01 [cite: 44]
4 | responseMessage | String | | Y | [cite_start]ResponseCode description information [cite: 44]
5 | transactionData | String | | N | [cite_start]Transaction data, JSON format string data. [cite: 44] (See specific transaction data 3) [cite_start][cite: 45]

[cite_start]Description [cite: 45]
[cite_start]In the case of whether it is necessary of the response parameter is "Y". [cite: 45] [cite_start]The arke application must return this parameter. [cite: 46] [cite_start]The Arke VAS applications get whether invoke success and the error message by the responseCode and responseMessage . [cite: 46]
[cite_start]In the case of whether it is necessary of the response parameter is "N". [cite: 47] [cite_start]The arke application does not necessarily return this parameter. [cite: 48] [cite_start]The Arke VAS application can be flexibly processed according to the actual return data item. [cite: 48]

[cite_start]Example (eg : Sale) [cite: 49]
[cite_start]@Override [cite: 49]
[cite_start]protected void onActivityResult(int requestCode, int resultCode, Intent intent) { [cite: 49]
    [cite_start]if (intent == null) { [cite: 49]
        [cite_start]return; [cite: 49]
    [cite_start]} [cite: 50]
    String applicationName = intent.getStringExtra("applicationName"); [cite_start]// ArkeAcquiringProject [cite: 50]
    String transactionName = intent.getStringExtra("transactionName"); [cite_start]// Consume [cite: 50]
    String responseCode = intent.getStringExtra("responseCode"); [cite_start]// 00 [cite: 50]
    String responseMessage = intent.getStringExtra("responseMessage"); [cite_start]// The transaction was successful [cite: 50, 51]
    [cite_start]String transactionData = intent.getStringExtra("transactionData"); [cite: 51]
[cite_start]} [cite: 51]
[cite_start]/* transactionData：{"amount":15.55,"authCode":"A54321","batchNumber":"000001","cardNumber":"6217001820017088497","expirationDate":"2404","merchantName":"ABCDEFGHIJKLMNOPQRSTUV 12345678901234","merchantNumber":"123456789012345","operatorNumber":"99","referenceNumber":"220511155957","responseCodeThirtyNine":"00","responseMessageThirtyNine":"[ 00 ] Transaction succeeded","terminalNumber":"12345678","transactionDate":"20170511","transactionName":"Consume","transactionTime":"155957","voucherNumber":"000038"}*/ [cite: 51]

3. [cite_start]Business Data [cite: 52]
[cite_start]3.1 Consume(Consume) [cite: 52]
[cite_start]Request Data [cite: 52]
[cite_start]The specific description of transactionData: [cite: 52]
Field Name | Data Type | [cite_start]Description [cite: 52]
orderNumber | String | [cite_start]The Arke VAS application order number [cite: 52]
amount | Double | [cite_start]Transaction amount [cite: 52]
needAppPrinted | Boolean | [cite_start]When the value is true , the receipt printed by the Arke VAS application. [cite: 52] [cite_start]If false , the receipt printed by the arke application [cite: 53]

[cite_start]Response Data [cite: 53]
[cite_start]The specific description of transactionData: [cite: 53]
Field Name | Data Type | [cite_start]Description [cite: 53]
responseCodeThirtyNine | String | [cite_start]Transaction result return code, 39 fields return codes, only when responseCode and responseCodeThirtyNine at the same time for the 00 , the transaction was successful [cite: 53]
responseMessageThirtyNine | String | [cite_start]Transaction 39 fields response Message [cite: 54]
amount | Double | [cite_start]Transaction amount [cite: 54]
merchantName | String | [cite_start]Merchant name [cite: 54]
merchantNumber | String | [cite_start]Merchant number [cite: 54]
terminalNumber | String | [cite_start]Terminal number [cite: 54]
operatorNumber | String | [cite_start]Operator number [cite: 54]
voucherNumber | String | [cite_start]Voucher number [cite: 54]
batchNumber | String | [cite_start]Batch number [cite: 54]
referenceNumber | String | [cite_start]Reference number [cite: 54]
authCode | String | [cite_start]Auth code [cite: 54]
transactionDate | String | [cite_start]Transaction date [cite: 54]
transactionTime | String | [cite_start]Transaction time [cite: 54]
cardNumber | String | [cite_start]Card number [cite: 54]
expirationDate | String | [cite_start]Expiration date [cite: 54]

[cite_start]3.2 Consume Revocation(Void) [cite: 55]
[cite_start]Request Data [cite: 55]
[cite_start]The specific description of transactionData: [cite: 55]
Field Name | Data Type | [cite_start]Description [cite: 55]
originalVoucherNumber | String | [cite_start]Original voucher number [cite: 55]
needAppPrinted | Boolean | [cite_start]When the value is true , the receipt printed by the Arke VAS application. [cite: 55] [cite_start]If false , the receipt printed by the arke application [cite: 56]

[cite_start]Response Data [cite: 56]
[cite_start]The specific description of transactionData: [cite: 56]
Field Name | Data Type | [cite_start]Description [cite: 56]
responseCodeThirtyNine | String | [cite_start]Transaction result return code, 39 fields return codes, only when responseCode and responseCodeThirtyNine at the same time for the 00 , the transaction was successful [cite: 56]
responseMessageThirtyNine | String | [cite_start]Transaction 39 fields response Message [cite: 57]
amount | Double | [cite_start]Transaction amount [cite: 57]
merchantName | String | [cite_start]Merchant name [cite: 57]
merchantNumber | String | [cite_start]Merchant number [cite: 57]
terminalNumber | String | [cite_start]Terminal number [cite: 57]
operatorNumber | String | [cite_start]Operator number [cite: 57]
voucherNumber | String | [cite_start]Voucher number [cite: 57]
batchNumber | String | [cite_start]Batch number [cite: 57]
referenceNumber | String | [cite_start]Reference number [cite: 57]
authCode | String | [cite_start]Auth code [cite: 57]
transactionDate | String | [cite_start]Transaction date [cite: 57]
transactionTime | String | [cite_start]Transaction time [cite: 57]
cardNumber | String | [cite_start]Card number [cite: 57]
expirationDate | String | [cite_start]Expiration date [cite: 57]

[cite_start]APPENDIX 1 : resultCode [cite: 58]
[cite_start]resultCode | description [cite: 58]
-101 | [cite_start]User Cancel [cite: 58]
-201 | [cite_start]Transaction Timeout [cite: 58]
-301 | [cite_start]Parameter error [cite: 58]
-401 | [cite_start]Pre-transaction error handling [cite: 58]
01 | [cite_start]Print error [cite: 58]

[cite_start]How to develop [cite: 58]
[cite_start]Preparation [cite: 58]
[cite_start]Has cloned the repository of arke-vas-demo.git [cite: 58]
[cite_start]Has been imported the arke-vas-demo project in Android Studio. [cite: 58] [cite_start]The path is: arke-vas-demo/src . [cite: 59]
[cite_start]If no, please refer to How to Run arke-vas-demo [cite: 59]
[cite_start]the path of detailed development documentation is arke-vas-demo/doc/The call interface of arke third-party-calling application.pdf [cite: 59]

[cite_start]Procedure [cite: 60]
[cite_start]Check whether the arke application is installed. [cite: 60] [cite_start]You can refer to the checkArkeAppInstalled() method in the ArkePayThirdCallActivity . [cite: 60]
[cite_start]Check whether the previous transaction request response is normal. [cite: 61] [cite_start]You can refer to the checkPreTransaction() method in the ArkePayThirdCallActivity . [cite: 61]
[cite_start]Set the request parameters and send the transaction request. [cite: 62] [cite_start]Among them the transaction data, transactionData is the json format. [cite: 62]
[cite_start]Intent intent = new Intent(); [cite: 63]
[cite_start]ComponentName componentName = new ComponentName("com.arke", "com.arke.thirdcalling.ThirdPartyCallActivity"); [cite: 63]
[cite_start]intent.setComponent(componentName); [cite: 63]
[cite_start]intent.putExtra("applicationName", "ArkeAcquiringProject"); [cite: 63]
[cite_start]intent.putExtra("transactionName", "Consume"); [cite: 63]
intent.putExtra("transactionData", transactionData); [cite_start]// transactionData : {"amount":100.00} [cite: 63]
[cite_start]startActivityForResult(intent, requestCode); [cite: 63]

[cite_start]Accept the transaction response data. [cite: 64] [cite_start]Among them the transaction data, transactionData is the json format. [cite: 64]
[cite_start]@Override [cite: 65]
[cite_start]protected void onActivityResult(int requestCode, int resultCode, Intent intent) { [cite: 65]
    if (intent == null) { return; [cite_start]} [cite: 65]
    String applicationName = intent.getStringExtra("applicationName"); [cite_start]// ArkeAcquiringProject [cite: 65, 66]
    String transactionName = intent.getStringExtra("transactionName"); [cite_start]// Consume [cite: 66]
    String responseCode = intent.getStringExtra("responseCode"); [cite_start]// 00 [cite: 66]
    String responseMessage = intent.getStringExtra("responseMessage"); [cite_start]// Transaction succeeded [cite: 66, 67]
    [cite_start]String transactionData = intent.getStringExtra("transactionData"); [cite: 67]
[cite_start]} [cite: 67]
[cite_start]/* transactionData：{"amount":15.55,"authCode":"A54321","batchNumber":"000001","cardNumber":"6217001820017088497","expirationDate":"2404","merchantName":"ABCDEFGHIJKLMNOPQRSTUV 12345678901234","merchantNumber":"123456789012345","operatorNumber":"99","referenceNumber":"220511155957","responseCodeThirtyNine":"00","responseMessageThirtyNine":"[ 00 ] Transaction succeeded","terminalNumber":"12345678","transactionDate":"20170511","transactionName":"Consume","transactionTime":"155957","voucherNumber":"000038"}*/ [cite: 67]

[cite_start]Compare the transaction request with the response order number, and check whether the request corresponds to the response message. [cite: 68]